/**
 * jquery.scrollless.scrollbar
 * Custom vertical scrollbar for jquery.scrollless
 * 
 * @version  1.0.0
 * @requires jquery.scrollless
 * @requires jquery.scrollless.affixnav
 * @author   Savr Goryaev (savreen.com/contact/)
 * @license  GPL v2 http://opensource.org/licenses/GPL-2.0
 */

(function(e){function w(t){if(!this||!E(t)){x();return}u=true;if(!f){a=this;var n=e(".affixnav");if(!n.length)return;f=e(s).html(i);n.eq(0).before(f);l=f.children(".scrollbar");c=l.children(".scrollbar-thumb")}f.show();L()}function E(e){if(!e||typeof e!="object")return false;if(!("scrollbar"in e))return true;if("disable"in e.scrollbar)return false;if("margin"in e.scrollbar)o=Math.floor(Number(e.scrollbar.margin));return true}function S(t,n){if(!u||!l||!t||!t.length)return;l.height(0);var r=0;f.children().each(function(){r+=e(this).height()});m=r;p=t.length;d.length=0;var i=[],s=0;for(var o=0;o<p;o++){i.push(s);s+=n[o]}i.push(s);for(o=0;o<=p;o++){d.push(i[o]/s)}if(h)return;h=f.children(".scrollbar-btn").on("click",C);f.find(".scrollbar-track").on("click",k)}function x(){if(!u||!l)return;u=false;f.hide()}function T(e){if(!u||typeof e!="object")return;if(!e.sizing){b=false;v=e.height-o-m;A()}else if(!b){b=true;L()}}function N(e){if(!u||typeof e!="object")return;g=e.start;y=e.end;O()}function C(t){if(!u)return;t.preventDefault();var n=e(this).hasClass("btn-up");if(n?g<2:y>=p-2)return;e.scrollless.setPos(n?0:p-1)}function k(t){if(!u)return;t.preventDefault();var n=l.offset().top;var r=t.pageY-n;var i=c.offset().top-n;if(r>i)e.scrollless.setPos(y);else e.scrollless.setPos({pos:g,right:g})}function L(){if(!l)return;v=0;l.hide();f.css("visibility","hidden")}function A(){if(!l)return;l.height(v).show();c.css("top",0).height(0);f.css("visibility","visible")}function O(){if(!c)return;var e=d[g],t=d[y];var n=Math.round(v*e),r=Math.round(v*t);var i=r-n>4?r-n:4;if(n+i>v)n=v-i-1;c.css("top",n).height(i)}e.scrollless.on("preInit",w).on("postInit",S).on("disable",x).on("changeSize",T).on("changePos",N);var t='<div class="btn-icon btn-icon-up"></div>';var n='<div class="btn-icon btn-icon-dn"></div>';var r='<div class="scrollbar-spacer"></div>';var i='<div class="scrollbar-btn btn-up">'+t+t+"</div>"+r+'<div class="scrollbar">'+'<div class="scrollbar-track">&nbsp;</div>'+'<div class="scrollbar-thumb"></div>'+"</div>"+r+'<div class="scrollbar-btn btn-dn">'+n+n+"</div>";var s='<td class="affixscrollbar"></td>';var o=4;var u=false;var a=0;var f=0;var l=0;var c=0;var h=0;var p=0;var d=[];var v=0;var m=0;var g=0;var y=0;var b=false})(jQuery)