/**
 * jquery.scrollless
 * Total replacement of native scrolling
 * https://github.com/hindmost/jquery.scrollless
 * 
 * @version  1.0.0
 * @requires jQuery
 * @author   Savr Goryaev (savreen.com/contact/)
 * @license  GPL v2 http://opensource.org/licenses/GPL-2.0
 */

(function(e){function B(t){if(!d)return false;p=true;P=nt;U();if(typeof t!="object")t={};for(var n in u)u[n].call(d,t);if(!j(t)||!d.children().length)return false;var i=e(document).height();Z();k=N;L=C;var s=C-i+d.height();x=r>0?Math.round(r<=1?s*r:Math.min(r,s)):s;v=e([]);g=e([]);try{I(d,0)}catch(f){return false}m=v.length;y=g.length;b.length=0;for(n=0;n<y;n++){b.push(g.eq(n).data("nestrange"));g.eq(n).removeData("nest")}et();if(o){v.addClass("scrollless-item");for(n=0;n<m;n++)v.eq(n).data("iItem",n)}for(n in a)a[n].call(d,v,S.slice());it();if(o){v.removeClass("scrollless-item");for(n=0;n<m;n++)v.eq(n).removeData("iItem")}return true}function j(e){if(!e||typeof e!="object")return false;if("position"in e)t=Math.floor(Number(e.position));if("itemQuota"in e&&e.itemQuota>=.1)r=Number(e.itemQuota);if("itemNestDepth"in e)n=Math.floor(Number(e.itemNestDepth));if("autoRestore"in e)s=Boolean(e.autoRestore);if("attachItemData"in e)o=Boolean(e.attachItemData);if("timePostpone"in e&&e.timePostpone>=300)i=Math.floor(Number(e.timePostpone));if("fnAnimate"in e&&typeof e.fnAnimate=="function")P=e.fnAnimate;if("fnAnimateEnd"in e&&typeof e.fnAnimateEnd=="function")H=e.fnAnimateEnd;return true}function F(e,t){if(typeof t=="function")e.push(t)}function I(t,r){if(r>n){throw 1;return}var i=t.children(),s=i.length,o=0;if(!s){throw 2;return}var u=["tbody","thead","tfoot"];for(var a=0;a<s;a++){var f=i.eq(a);var l=f.get(0).currentStyle||window.getComputedStyle(f.get(0),null);if(l.display=="inline"||l.display=="table-cell")break;var c=e.inArray(f.get(0).tagName.toLowerCase(),u)>=0;if(!c&&f.height()<x)continue;v=v.add(i.slice(o,a));o=a+1;var h=v.length;I(f,r+1);f.data("nestrange",[h,v.length]);g=g.add(f)}if(o<s)v=v.add(o?i.slice(o,s):i)}function q(){Q();if(!p){if(s&&Z()&&N>=A&&C>=O)K();return}if(Z()){it(true);X(true)}D=setTimeout(R,i)}function R(){Q();if(!p)return;Z();if(N!=k){et();v.slice(M,_).show();rt()}if(N>k||C>L){$()}k=N;L=C;if(k*L<A*O){A=k;O=L}it();X();ut(true)}function U(){M=_=0}function z(e,t,n,r){e=typeof e=="number"?e:0;if(!(e>=0&&e<m)||_>=m&&e>M)return;var i=C-T;var s=typeof t=="number"&&t>=0&&t<=e,o=typeof n=="number"&&n>0&&n<m;t=s?t:0;n=o?n:m;for(var u=0,a=e;a<n&&u+S[a]<i;a++)u+=S[a];var f=e,l=a;if(o||l==m){for(a=f-1;a>=t&&u+S[a]<i;a--)u+=S[a];if(a+1<f&&a+1!=M)f=a+1}if(o&&f==t){for(a=l;a<m&&u+S[a]<i;a++)u+=S[a];if(a>l)l=a}if(f==l){J(true);return}if(f==M&&l==_)return;var c=M,h=_;M=f;_=l;ut();if(r){v.hide().slice(f,l).show();W();return}if(H)H();var p={height:i,startPrev:c,endPrev:h,start:f,end:l};P(p)}function W(){rt();X();ut()}function X(e){if(_-M<=1)return false;var t=V();if(t<=0)return false;if(e)tt();for(var n=0,r=_-1;r>M&&(n+=S[r])<t;r--);if(r<=M){if(!e)J(true);return false}v.slice(r,_).hide();_=r;rt();if(e||(t=V())<=0)return true;J(true);return true}function V(){return e(document).height()-C}function $(){if(_==m)return;for(var e=0,t=M;t<_;t++)e+=S[t];var n=e;var r=C-T-n;if(r<=0)return;for(e=0,t=_;t<m&&(e+=S[t])<r;t++);if(t==_)return;v.slice(_,t).show();_=t;rt();X()}function J(e){if(!p)return;p=false;if(H)H();U();if(e){if(m)v.show();if(y)g.show()}if(!f.length)return;for(var t in f)f[t]()}function K(){if(B())z(M,null,null,true);else J(false)}function Q(){if(D)clearTimeout(D)}function Z(){G=N;Y=C;N=e(window).width();C=e(window).height();if(N==G&&C==Y)return false;return true}function et(){var t=e(document).height(),n=d.height();var r=d.get(0).style;r.visibility="hidden";r.height=x;r.width=d.width();v.show();var i=e(document).height(),s=d.height();T=i-s+1;S.length=w.length=E.length=0;var o=[];var u=d.height();for(var a=0,f=m-1;f>=0;f--){var l=v.eq(f).height();v.eq(f).hide();var c=d.height();a+=o[f]=Math.max(u-c,0);E[f]=Math.max(o[f]-l,0);u=c}if(y)g.hide();r.height=r.width="auto";r.visibility="visible";w=o.slice();S=o.slice();var h=Math.max(s-a,0)}function tt(){for(var e=0,t=M;t<_;t++){e+=S[t]=v.eq(t).height()+E[t]}}function nt(e){if(e.expand)v.slice(_,e.end).show();else v.hide().slice(e.start,e.end).show();W()}function rt(){var e=[];for(var t=0;t<y;t++){var n=b[t],r=n[0],i=n[1];(e[t]=r<_&&M<i)?g.eq(t).show():g.eq(t).hide()}}function it(e){if(!l.length)return;var t={sizing:Boolean(e),height:C-T};for(var n in l)l[n](t)}function ut(e){if(!c.length)return;if(!e&&M==st&&_==ot)return;st=M;ot=_;var t={items:m,start:M,end:_};for(var n in c)c[n](t);if(V()>0)J(true)}var t=0;var n=5;var r=0;var i=500;var s=true;var o=false;var u=[];var a=[];var f=[];var l=[];var c=[];var h={preInit:u,postInit:a,disable:f,changeSize:l,changePos:c};var p=false;var d=0;var v=0;var m=0;var g=0;var y=0;var b=[];var w=[];var E=[];var S=[];var x=0;var T=0;var N=0;var C=0;var k=0;var L=0;var A=0;var O=0;var M=0;var _=0;var D=0;var P=0;var H=0;e.scrollless={on:function(e,t){if(e in h)F(h[e],t);return this},setPos:function(e){if(typeof e=="object")z(e.pos,e.left,e.right);else if(typeof e=="number")z(e)},setPosComplete:function(){W()},disable:function(){J(false)}};e.fn.scrollless=function(n){if(!((!n||typeof n=="object")&&this&&this.length))return this;if(!d){d=this.eq(0);d.css({overflow:"hidden"});e(window).on("resize",function(){q()})}if(B(n))z(t,null,null,true);else J(false);return this};var G=0;var Y=0;var st=0;var ot=0})(jQuery)